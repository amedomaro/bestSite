<div th:fragment="translation">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', getLocalLang)

        var arrLang = {
            'en': {
                'home': 'Home page',
                'overview': 'Overview',
                'add-review': 'Add review',
                'profile': 'My profile',
                'admin': 'Administration',
                'login': 'Login',
                'logout': 'Exit',
                'register': 'Register',
            },
            'ru': {
                'home': 'Главная страница',
                'overview': 'Обзоры',
                'add-review': 'Добавить обзор',
                'profile': 'Мой профиль',
                'admin': 'Администрирование',
                'login' : 'Войти',
                'logout' : 'Выйти',
                'register' : 'Зарегистрироваться',
            }
        }

        $(function () {
            $('.translate').click(function () {
                var lang = $(this).attr('id');
                saveLocalLang(lang)
                $('.lang').each(function (index, item) {
                    $(this).text(arrLang[lang][$(this).attr('key')]);
                });
            });
        });

        function saveLocalLang(language) {
            let langs
            if (localStorage.getItem('langs') === null) {
                langs = []
            } else {
                langs = JSON.parse(localStorage.getItem('langs'))
            }
            langs.push(language)
            localStorage.setItem('langs', JSON.stringify(langs))
        }

        function getLocalLang() {
            let langs
            if (localStorage.getItem('langs') === null) {
                langs = []
            } else {
                langs = JSON.parse(localStorage.getItem('langs'))
            }
            langs.forEach(function (language) {
                let lang = langs[langs.length - 1]
                setTimeout(() => {
                    $('.lang').each(function (index, item) {
                        $(this).text(arrLang[lang][$(this).attr('key')]);
                    });
                }, 0)
            })
        }
    </script>
    <script src="https://kit.fontawesome.com/c833054982.js" crossorigin="anonymous"></script>
</div>